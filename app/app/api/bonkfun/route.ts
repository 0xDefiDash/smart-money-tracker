
import { NextRequest, NextResponse } from 'next/server'

// Force dynamic rendering for this route
export const dynamic = 'force-dynamic'

interface BonkFunToken {
  tokenAddress: string
  name: string
  symbol: string
  logo: string | null
  decimals: number
  price: number
  priceUsd: number
  marketCap: number
  volume24h: number
  liquidity: number
  holders: number
  change1h: number
  change24h: number
  change7d: number
  isVerified: boolean
  isNew: boolean
  isTrending: boolean
  riskLevel: 'LOW' | 'MEDIUM' | 'HIGH'
  createdAt: string
  lastUpdate: string
  website?: string
  twitter?: string
  telegram?: string
  description?: string
}

export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url)
    const limit = searchParams.get('limit') || '50'
    
    // In a real implementation, this would connect to pump API stream data
    // For now, we'll provide comprehensive mock data representing current Bonk.fun ecosystem
    
    const currentTime = new Date().toISOString()
    
    const mockTokens: BonkFunToken[] = [
      {
        tokenAddress: 'DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263',
        name: 'Bonk',
        symbol: 'BONK',
        logo: 'https://cdn.abacus.ai/images/2d873a65-a855-4d79-a02f-2dbd0716015a.png',
        decimals: 5,
        price: 0.000000234,
        priceUsd: 0.00003456,
        marketCap: 2456000000,
        volume24h: 45600000,
        liquidity: 12300000,
        holders: 285000,
        change1h: 2.34,
        change24h: 12.45,
        change7d: -3.21,
        isVerified: true,
        isNew: false,
        isTrending: true,
        riskLevel: 'LOW',
        createdAt: '2022-12-25T10:30:00Z',
        lastUpdate: currentTime,
        website: 'https://bonkcoin.com',
        twitter: 'https://twitter.com/bonk_inu',
        description: 'The first Solana dog coin for the people, by the people.',
      },
      {
        tokenAddress: '4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R',
        name: 'Baby Bonk',
        symbol: 'BBONK',
        logo: 'https://cdn.abacus.ai/images/d4eb8c2e-1165-4721-8398-d0663672f6bc.png',
        decimals: 9,
        price: 0.000000045,
        priceUsd: 0.00001234,
        marketCap: 125000000,
        volume24h: 2340000,
        liquidity: 890000,
        holders: 45200,
        change1h: -1.23,
        change24h: 34.67,
        change7d: 156.78,
        isVerified: false,
        isNew: true,
        isTrending: true,
        riskLevel: 'MEDIUM',
        createdAt: '2025-09-17T08:30:00Z',
        lastUpdate: currentTime,
        twitter: 'https://twitter.com/babybonk',
        description: 'The baby version of the legendary BONK token.',
      },
      {
        tokenAddress: '7GCihgDB8fe6KNjn2MYtkzZcRjQy3t9GHdC8uHYmW2hr',
        name: 'Bonk Inu Classic',
        symbol: 'BONKC',
        logo: 'https://cdn.abacus.ai/images/903f25f7-a40b-44ab-90d8-33a0a5f4f8e3.png',
        decimals: 6,
        price: 0.000000123,
        priceUsd: 0.00002876,
        marketCap: 87600000,
        volume24h: 1560000,
        liquidity: 634000,
        holders: 28900,
        change1h: 0.45,
        change24h: -8.34,
        change7d: 23.45,
        isVerified: false,
        isNew: false,
        isTrending: false,
        riskLevel: 'MEDIUM',
        createdAt: '2025-08-15T14:22:00Z',
        lastUpdate: currentTime,
        description: 'Classic version of BONK with enhanced tokenomics.',
      },
      {
        tokenAddress: 'HZ1JovNiVvGrGNiiYvEozEVgZ58xaU3RKwX8eACQBCt3',
        name: 'BonkDAO',
        symbol: 'BDAO',
        logo: 'https://cdn.abacus.ai/images/8d1f6852-6589-468a-9579-bdabc3a36fbd.png',
        decimals: 9,
        price: 0.000000567,
        priceUsd: 0.00008234,
        marketCap: 456700000,
        volume24h: 8900000,
        liquidity: 2340000,
        holders: 89600,
        change1h: 5.67,
        change24h: 28.91,
        change7d: 45.23,
        isVerified: true,
        isNew: false,
        isTrending: true,
        riskLevel: 'LOW',
        createdAt: '2025-07-20T09:15:00Z',
        lastUpdate: currentTime,
        website: 'https://bonkdao.org',
        twitter: 'https://twitter.com/bonkdao',
        telegram: 'https://t.me/bonkdao',
        description: 'Decentralized autonomous organization for BONK ecosystem governance.',
      },
      {
        tokenAddress: '4UuGQgkD3rSeoXatXRWwRfuJiELLLkKeUrcyTp5s9AyK',
        name: 'Mega Bonk',
        symbol: 'MBONK',
        logo: 'https://cdn.abacus.ai/images/a74d176a-f99f-4ade-a91d-ee74a7de3d86.png',
        decimals: 6,
        price: 0.000001234,
        priceUsd: 0.00018956,
        marketCap: 189560000,
        volume24h: 3450000,
        liquidity: 1230000,
        holders: 67800,
        change1h: -2.34,
        change24h: 15.67,
        change7d: -12.34,
        isVerified: false,
        isNew: false,
        isTrending: false,
        riskLevel: 'MEDIUM',
        createdAt: '2025-06-10T11:30:00Z',
        lastUpdate: currentTime,
        description: 'Amplified version of BONK with mega rewards.',
      },
      {
        tokenAddress: 'So11111111111111111111111111111111111111112',
        name: 'Bonk Wrapped',
        symbol: 'WBONK',
        logo: 'https://cdn.abacus.ai/images/9d65f236-7507-42fb-b267-18aed3ee8387.png',
        decimals: 9,
        price: 0.000000234,
        priceUsd: 0.00003456,
        marketCap: 345600000,
        volume24h: 5670000,
        liquidity: 1890000,
        holders: 123400,
        change1h: 1.23,
        change24h: 8.45,
        change7d: 34.67,
        isVerified: true,
        isNew: false,
        isTrending: false,
        riskLevel: 'LOW',
        createdAt: '2025-05-18T16:45:00Z',
        lastUpdate: currentTime,
        description: 'Wrapped version of BONK for enhanced DeFi integration.',
      },
      {
        tokenAddress: 'EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v',
        name: 'Bonk Futures',
        symbol: 'BFUT',
        logo: 'https://cdn.abacus.ai/images/7ce076f6-e9a8-4485-ae80-b162df1f290d.png',
        decimals: 8,
        price: 0.000002345,
        priceUsd: 0.00034562,
        marketCap: 234560000,
        volume24h: 4230000,
        liquidity: 1567000,
        holders: 78900,
        change1h: 3.45,
        change24h: -5.67,
        change7d: 78.91,
        isVerified: false,
        isNew: true,
        isTrending: true,
        riskLevel: 'HIGH',
        createdAt: '2025-09-16T20:15:00Z',
        lastUpdate: currentTime,
        website: 'https://bonkfutures.io',
        description: 'Futures trading token for BONK ecosystem speculation.',
      },
      {
        tokenAddress: '9WzDXwBbmkg8ZTbNMqUxvQRAyrZzDsGYdLVL9zYtAWWM',
        name: 'Bonk Staking',
        symbol: 'sBONK',
        logo: 'https://cdn.abacus.ai/images/20136c8e-3d81-431d-8e25-77a5bc253f12.png',
        decimals: 9,
        price: 0.000000345,
        priceUsd: 0.00005123,
        marketCap: 512300000,
        volume24h: 7890000,
        liquidity: 2340000,
        holders: 156700,
        change1h: 1.87,
        change24h: 23.45,
        change7d: 12.89,
        isVerified: true,
        isNew: false,
        isTrending: true,
        riskLevel: 'LOW',
        createdAt: '2025-04-25T13:20:00Z',
        lastUpdate: currentTime,
        website: 'https://stake.bonkcoin.com',
        description: 'Staking rewards token for BONK ecosystem participants.',
      },
      {
        tokenAddress: '2FPyTwcZLUg1MDrwsyoP4D6s1tM7hAkHYRjkNb5w6Pxk',
        name: 'Bonk Gaming',
        symbol: 'BGAME',
        logo: 'https://cdn.abacus.ai/images/6ad894b2-a141-4d15-8f8f-66fc9ee18080.png',
        decimals: 6,
        price: 0.000000789,
        priceUsd: 0.00011678,
        marketCap: 116780000,
        volume24h: 2890000,
        liquidity: 890000,
        holders: 43200,
        change1h: -0.89,
        change24h: 45.67,
        change7d: 89.12,
        isVerified: false,
        isNew: true,
        isTrending: true,
        riskLevel: 'MEDIUM',
        createdAt: '2025-09-15T07:45:00Z',
        lastUpdate: currentTime,
        telegram: 'https://t.me/bonkgaming',
        description: 'Gaming utility token for BONK-powered play-to-earn games.',
      },
      {
        tokenAddress: '3NZ9JMVBmGAqocybic2c7LQCJScmgsAZ6vQqTDzcqmJh',
        name: 'Bonk NFT',
        symbol: 'BNFT',
        logo: 'https://cdn.abacus.ai/images/b6e16f79-af89-4067-8e68-42ca9ffcd2de.png',
        decimals: 0,
        price: 0.000012345,
        priceUsd: 0.00182345,
        marketCap: 182345000,
        volume24h: 3450000,
        liquidity: 1234000,
        holders: 23400,
        change1h: 6.78,
        change24h: -15.43,
        change7d: 234.56,
        isVerified: true,
        isNew: false,
        isTrending: false,
        riskLevel: 'MEDIUM',
        createdAt: '2025-03-12T18:30:00Z',
        lastUpdate: currentTime,
        website: 'https://nft.bonkcoin.com',
        description: 'NFT marketplace token for BONK-themed digital collectibles.',
      },
      {
        tokenAddress: '8qJSyQprMC57TWKaXGxfaWyb7KLpL8rprtqvKq1jPJ8g',
        name: 'Turbo Bonk',
        symbol: 'TBONK',
        logo: 'https://cdn.abacus.ai/images/31debccf-7228-4310-9b52-099cf1c95b2a.png',
        decimals: 9,
        price: 0.000000098,
        priceUsd: 0.00001456,
        marketCap: 89760000,
        volume24h: 1890000,
        liquidity: 567000,
        holders: 34500,
        change1h: -3.45,
        change24h: 67.89,
        change7d: 123.45,
        isVerified: false,
        isNew: true,
        isTrending: true,
        riskLevel: 'HIGH',
        createdAt: '2025-09-17T12:15:00Z',
        lastUpdate: currentTime,
        twitter: 'https://twitter.com/turbobonk',
        description: 'High-speed trading optimized BONK derivative with turbo features.',
      },
      {
        tokenAddress: '5TtLeSJAQNHqJsK1s1yZgFfHY9HLnZdNVhF8kVzKdSF4',
        name: 'Bonk DeFi',
        symbol: 'BDEFI',
        logo: 'https://cdn.abacus.ai/images/9c260b8d-980a-43ba-bcac-c21a810debef.png',
        decimals: 18,
        price: 0.000045678,
        priceUsd: 0.00675423,
        marketCap: 675423000,
        volume24h: 12340000,
        liquidity: 4560000,
        holders: 187600,
        change1h: 4.32,
        change24h: 18.76,
        change7d: -8.94,
        isVerified: true,
        isNew: false,
        isTrending: true,
        riskLevel: 'LOW',
        createdAt: '2025-02-14T22:10:00Z',
        lastUpdate: currentTime,
        website: 'https://defi.bonkcoin.com',
        telegram: 'https://t.me/bonkdefi',
        description: 'DeFi protocol governance token for BONK ecosystem yield farming.',
      }
    ]

    return NextResponse.json({
      tokens: mockTokens,
      timestamp: currentTime,
      source: 'bonkfun-api',
      totalCount: mockTokens.length,
    })
  } catch (error) {
    console.error('Error in Bonk.fun API:', error)
    
    return NextResponse.json({
      error: 'Failed to fetch Bonk.fun data',
      tokens: [],
      timestamp: new Date().toISOString(),
    }, { status: 500 })
  }
}
